# 单点登录

单点登录（SSO）定义在多个应用系统中，用户只需要登录一次就可以访问所有相互信任的应用系统。SSO 一般需要一个独立的认证中心（passport）一个系统登录成功后，passport 将会颁发一个令牌给各个子系统，拥有了令牌后就可以访问各个子系统受保护的资源，减少频繁的向 passport 发起认证

## 如何实现

### 相同域名下单点登录：

通过`cookie`的`domain`属性，将其设置为父域域名，同时将`cookie`的`path`设置为根路径，`token`或`session ID`保存在父域中，这样所有的子域就都可以访问到这个`cookie`

### 不同域名下单点登录：

部署一个专门处理登录请求的认证中心，用户统一在认证中心登录，登录后认证中心记录用户的登录状态，并将`token`写入`cookie`。当打开一个应用系统时，应用系统会检查当前请求有没有`token`，若没有就会跳转到认证中心，认证中心根据`cookie`判断用户此前是否登录，若没有登录则跳转到登录页面等待用户登录，若登录则携带生成的`token`跳转回目标 url。目标应用系统拿到`token`后会再次向认证中心确认`token`的合法性，以防止用户伪造。确认无误后就会记录用户的登录状态，并将`token`写入当前域的`cookie`中。
