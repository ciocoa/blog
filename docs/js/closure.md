# 作用域和闭包

## 作用域

作用域就是可以有效访问变量或函数的区域，js 有三种类型的作用域：

- 全局作用域，即在全局命名空间里声明的变量或函数，在代码的任何地方都能访问
- 函数作用域，也叫局部作用域即在函数内部进行声明，每个函数都有自己的上下文和可变对象，这些环境用于存储上下文的变量、参数、函数声明等
- 块级作用域，即在`{}`中使用`let`和`const`声明的变量，只能在其中访问

## 作用域链

作用域也可以看作是一组用于查找变量的规则，变量在当前作用域中不存在，则向上级作用域查找，如果仍不存在则再次向上查找，直至全局作用域，这种查找也叫作用域链

## 闭包

闭包就是一个函数在声明时能记住当前作用域，上级作用域以及其上声明的变量函数等，直至全局作用域。闭包是在声明函数时创建的作用域，可以在一个内层函数中访问到其他外层函数，简单理解为定义在函数内部的函数，函数作为返回值始终保持在内存中，实际应用于封装变量，收敛权限。闭包可能造成内存空间无法被 gc 回收，内存消耗过高甚至内存泄露。

## 函数缓存

- 闭包
- 柯里化函数把接收多个参数的函数转换成接受一个单一参数的函数，目的在于避免频繁的调用具有相同参数函数，轻松重用。
- 高阶函数：通过接收其他函数作为参数或返回其他函数的函数

## 内存泄露

由于疏忽或错误导致程序为能释放已不再使用的内存

JS 的垃圾回收机制：

- 标记清除：变量在进入执行环境时被标记为进入环境，在离开时被标记为离开环境；GC 在运行时，会标记内存中所有变量，然后将上下文中的变量及上下文引用的变量的标记去掉。之后被标记的变量就是不再需要的，待删除了的
- 引用计数：JS 引擎中有一张引用表，保存了内存中的所有资源的引用次数，当引用次数为 0，即为不需要的，就可以释放这块内存
